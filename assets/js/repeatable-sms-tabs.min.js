jQuery(document).ready(function() {
	
	/*
		Add a new tab
	*/
	jQuery( '#add_another_tab' ).on( 'click' , function( e ) {
		
		// setup variables for use in generating a new tab
		var clone_container = jQuery( '#duplicate_this_row' );
		var before_add_count = jQuery( '#number_of_tabs' ).val();
		var new_count = parseInt(jQuery( '#number_of_tabs' ).val())+parseInt(1); /* get new number of cloned element */
		var remove_tab_button = jQuery( '#duplicate_this_row .remove_this_tab' );
		var move_tab_content_buttons = jQuery( '#duplicate_this_row .button-holder' );
			
		clone_container.children( 'p' ).each(function() {
			
			jQuery(this).clone().insertBefore( '#duplicate_this_row' ).removeClass('hidden_duplicator_row_title_field').removeClass('hidden_duplicator_row_content_field').addClass('new_duplicate_row');
		
		}).promise().done(function() {
						
			jQuery( '.new_duplicate_row' ).find('input').each(function() {
				if ( jQuery(this).is('input[name="hidden_duplicator_row_title"]') ) {
					jQuery(this).attr( 'name' , '_hannanstd_wc_custom_repeatable_product_tabs_tab_title_'+new_count ).attr( 'id' , '_hannanstd_wc_custom_repeatable_product_tabs_tab_title_'+new_count ).parents('p').addClass('_hannanstd_wc_custom_repeatable_product_tabs_tab_title_'+new_count+'_field').removeClass('hidden_duplicator_row_title_field').find('label').removeAttr('for').attr('for','_hannanstd_wc_custom_repeatable_product_tabs_tab_title_'+new_count+'_field');
				}
			});
			
			jQuery( '.new_duplicate_row' ).find('select').each(function() {
				if ( jQuery(this).is('select[name="hidden_duplicator_row_content[]"]') ) {
					jQuery(this).attr( 'name' , '_hannanstd_wc_custom_repeatable_product_tabs_tab_content_'+new_count+'[]' ).attr( 'id' , '_hannanstd_wc_custom_repeatable_product_tabs_tab_content_'+new_count ).parents('p').addClass('_hannanstd_wc_custom_repeatable_product_tabs_tab_content_'+new_count+'_field').removeClass('hidden_duplicator_row_content_field').find('label').removeAttr('for').attr('for','_hannanstd_wc_custom_repeatable_product_tabs_tab_content_'+new_count+'_field');	
				}
			});
			
			// set the new value
			jQuery( '#number_of_tabs' ).val(new_count);	
			// append the divider, between tab data
			jQuery( '.new_duplicate_row' ).first().before( '<div class="hannanstd-woo-custom-tab-divider"></div>' );
			
		});
		
		move_tab_content_buttons.clone().insertAfter( jQuery( '.hannanstd-woo-custom-tab-divider').last() ).addClass( 'last-button-holder' );	
	
		remove_tab_button.clone().prependTo( '.last-button-holder' ).removeAttr( 'style' );
		jQuery( '.last-button-holder' ).removeAttr( 'alt' ).attr( 'alt' , new_count );
		
		setTimeout(function() {
			jQuery( '.last-button-holder' ).removeClass( 'last-button-holder' );
			jQuery( '.new_duplicate_row' ).removeClass( 'new_duplicate_row' );
		},100);
		
		e.preventDefault();
		
	});
	// end duplicate tab
	
	/*
		Remove a new tab
	*/
	jQuery( 'body' ).on( 'click' , '.remove_this_tab' , function( e ) {
		
		// setup our variables for use in tab removal
		var clicked_button = jQuery( this );				
		var tab_title_to_remove = jQuery( this ).parents( '.button-holder' ).next();
		var tab_content_to_remove = jQuery( this ).parents( '.button-holder' ).next().next();
		var divider_to_remove = jQuery( this ).parents( '.button-holder' ).prev();
		var before_remove_count = jQuery('#number_of_tabs').val();
		var count_post_remove = parseInt( jQuery('#number_of_tabs').val() )-parseInt(1); /* get new number of cloned element */
		
		tab_title_to_remove.remove();
		tab_content_to_remove.remove();
		divider_to_remove.remove();
		clicked_button.parents( '.button-holder' ).remove();
		
		
		
		e.preventDefault();
		
	});
	// end remove
	

	/* 
		How To Click 
		- slide out display
	*/
	jQuery( '.hannanstd-tabs-how-to-toggle' ).on( 'click' , function( e ) {
		jQuery( '.hannanstd-woo-tabs-hidden-how-to-info' ).slideToggle( 'fast' );
	});
	
});